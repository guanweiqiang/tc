<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>个人中心 - MyProject</title>
<!--    <link rel="stylesheet" href="css/style.css">-->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/profile.css">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>

<header>
    <div class="nav">
        <div class="nav-left">
            <a href="index.html" class="logo">MyProject</a>
            <nav class="main-nav">
                <a href="index.html" class="active">首页</a>
                <a href="article.html">文章列表</a>
            </nav>
        </div>

        <div class="nav-right">
            <a href="javascript:void(0)" class="nav-publish-btn" id="publishBtn">
                <i data-lucide="pen-line"></i> <span>写文章</span>
            </a>

            <a href="login.html" id="loginLink" class="btn-primary" style="padding: 10px 24px; border-radius: 12px;">登录 / 注册</a>

            <div class="avatar-wrapper" id="avatarWrapper" style="display: none; position: relative; padding: 5px 0;">
                <div class="avatar-container">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" class="avatar" id="userAvatar">
                </div>

                <div class="dropdown">
                    <div class="dropdown-header">账号管理</div>
                    <div style="padding: 0 12px 10px; font-weight: 700; color: var(--text-title); font-size: 15px;">
                        <span id="navNickname">用户名</span>
                    </div>
                    <hr style="border:0; border-top:1px solid #f0f0f0; margin:5px 10px 10px;">

                    <a href="profile.html"><i data-lucide="user"></i> 个人中心</a>
                    <a href="myArticles.html"><i data-lucide="layout-list"></i> 我的文章</a>

                    <a href="javascript:void(0)" id="logoutBtn" style="color: #FF4D4F; margin-top: 5px;">
                        <i data-lucide="log-out"></i> 退出登录
                    </a>
                </div>
            </div>
        </div>
    </div>
</header>

<div id="profilePageContainer">
    <aside class="profile-sidebar">
        <div class="sidebar-title">设置中心</div>
        <div class="menu-item active" onclick="switchTab('info', this)">
            <i data-lucide="user-circle"></i> <span>基本资料</span>
        </div>
        <div class="menu-item" onclick="switchTab('email', this)">
            <i data-lucide="mail"></i> <span>修改邮箱</span>
        </div>
        <div class="menu-item" onclick="switchTab('pwd', this)">
            <i data-lucide="shield-check"></i> <span>修改密码</span>
        </div>
    </aside>

    <main class="profile-main-content">
        <section id="infoSection" class="section active">
            <div class="section-header">
                <h2>基本资料</h2>
                <p>管理您的个人公共信息</p>
            </div>

            <div class="profile-avatar-upload">
                <div class="big-avatar-wrapper">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" class="big-avatar-circle" id="mainAvatar">
                    <label for="avatarInput" class="avatar-edit-badge">
                        <i data-lucide="camera" size="16"></i>
                    </label>
                </div>
                <input type="file" id="avatarInput" hidden onchange="uploadFile()">
                <div class="avatar-info">
                    <h3 style="font-size: 18px; color: var(--text-title);">个人头像</h3>
                    <p>点击图标更换头像，支持更清晰的展示效果</p>
                </div>
            </div>

            <div class="form-container">
                <div class="form-group">
                    <label>用户名</label>
                    <input type="text" id="username" disabled class="disabled-input">
                    <span class="input-hint">用户名暂不支持修改</span>
                </div>

                <div class="form-group">
                    <label>昵称</label>
                    <div class="input-with-btn">
                        <input type="text" id="nickname" placeholder="想个好听的名字...">
                        <button class="btn-primary" onclick="saveNickname()">更新</button>
                    </div>
                </div>

                <div class="form-group">
                    <label>当前绑定邮箱</label>
                    <div class="input-readonly-box">
                        <span id="emailDisplay">example@mail.com</span>
                        <a href="javascript:void(0)" onclick="switchTab('email', document.querySelectorAll('.menu-item')[1])">更改</a>
                    </div>
                </div>
            </div>
            <div id="infoMsg" class="msg-tip"></div>
        </section>

        <section id="emailSection" class="section">
            <div class="section-header">
                <h2>修改邮箱</h2>
                <p id="emailStepDesc">第一步：验证当前绑定邮箱</p>
            </div>

            <div id="step1_verifyOld">
                <div class="form-container">
                    <div class="form-group">
                        <label>当前邮箱</label>
                        <input type="text" id="oldEmailDisplay" disabled class="disabled-input">
                    </div>
                    <div class="form-group">
                        <label>验证码</label>
                        <div class="input-with-btn">
                            <input type="text" id="oldEmailCode" placeholder="输入旧邮箱验证码">
                            <button class="btn-secondary" id="sendOldBtn" onclick="sendOldEmailCode()">获取验证码</button>
                        </div>
                    </div>
                    <button class="btn-primary full-width" onclick="verifyOldEmail()">下一步</button>
                </div>
            </div>

            <div id="step2_bindNew" style="display: none;">
                <div class="form-container">
                    <div class="form-group">
                        <label>新邮箱地址</label>
                        <input type="email" id="newEmail" placeholder="请输入新邮箱地址">
                    </div>
                    <div class="form-group">
                        <label>新邮箱验证码</label>
                        <div class="input-with-btn">
                            <input type="text" id="newEmailCode" placeholder="输入新邮箱验证码">
                            <button class="btn-secondary" id="sendNewBtn" onclick="sendNewEmailCode()">获取验证码</button>
                        </div>
                    </div>
                    <button class="btn-primary full-width" onclick="saveNewEmail()">确认绑定</button>
                    <button class="btn-ghost" style="width: 100%; margin-top: 10px;" onclick="resetEmailStep()">返回上一步</button>
                </div>
            </div>

            <div id="emailMsg" class="msg-tip"></div>
        </section>

        <section id="pwdSection" class="section">
            <div class="section-header">
                <h2>安全设置</h2>
                <p>为了您的账户安全，建议定期更换复杂的密码</p>
            </div>
            <div class="form-container">
                <div class="form-group">
                    <label>原密码</label>
                    <input type="password" id="oldPwd" placeholder="请输入当前旧密码">
                </div>
                <div class="form-group">
                    <label>新密码</label>
                    <div class="password-input-wrapper">
                        <input type="password" id="newPwd" placeholder="至少 8 位，包含字母数字">
                        <i data-lucide="eye" class="toggle-pwd" onclick="togglePwd('newPwd')"></i>
                    </div>
                </div>
                <div class="form-group">
                    <label>确认新密码</label>
                    <input type="password" id="confirmPwd" placeholder="请再次输入新密码">
                </div>
                <button class="btn-primary full-width" onclick="savePwd()">重置密码</button>
            </div>
            <div id="pwdMsg" class="msg-tip"></div>
        </section>
    </main>
</div>


<script src="js/nav-bar.js"></script>
<script src="./js/profile.js"></script>

<script>
    // 初始化图标
    lucide.createIcons();
</script>
</body>
</html>